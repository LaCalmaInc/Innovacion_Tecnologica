<!DOCTYPE html>
<!-- saved from url=(0047)https://casino.usm.cl/solicitud/MisConsumosMenu -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="./MisConsumos_files/bootstrap.min.css">
        <link href="./MisConsumos_files/estilo.css" rel="stylesheet" type="text/css">
        <link href="./MisConsumos_files/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css">
        <link href="./MisConsumos_files/daterangepicker.css" rel="stylesheet" type="text/css">
        <link href="./MisConsumos_files/all.css" rel="stylesheet" type="text/css">
        <link href="./MisConsumos_files/datatables.min.css" rel="stylesheet" type="text/css">
        <link href="./MisConsumos_files/select2.min.css" rel="stylesheet" type="text/css">
        <!-- Bootstrap CSS (para botones y modales) -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

<!-- DataTables CSS (para la tabla interactiva) -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">

<!-- Font Awesome (para el icono de estrella opcional) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<!-- jQuery (necesario para todo el JS) -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <title>Casino de Alimentación</title>
        <style>
            label i {
                display: none !important;
            }
            label:hover i {
                display: inline-block !important;
            }
            label i:hover{
                cursor: help
            }
            table.dataTable thead th, table.dataTable thead td{
                     border-bottom: 0px ;
                
            }
        </style>
    <style type="text/css" id="operaUserStyle"></style></head>
    <script>
  window.addEventListener("DOMContentLoaded", () => {
    const name = localStorage.getItem("userName");
    if (!name) {
      // si no hay sesión activa
      window.location.href = "login.html";
      return;
    }
    // Actualizar TODOS los spans de usuario
    document
      .querySelectorAll(".link-top-bar.single-link.external")
      .forEach(el => el.textContent = name);
  });
</script>
    <body class="body-usm">   
        <a style="display: none" id="volver">aqui</a>
               



<link rel="stylesheet" href="./MisConsumos_files/normalize.css">
<link rel="stylesheet" href="./MisConsumos_files/usm-estilo.css">
<link href="./MisConsumos_files/css2" rel="stylesheet">
<header id="header" class="container-fluid">
    <div class="row top-bar">
        <div class="container">
            <div class="row justify-content-between">
                <div class="col-4 ocultar-mobile">
                    <ul class="breadcrumbs">
                        <li>
                            <a > USM.cl</a>
                        </li>
                    </ul>
                </div>
                <div class="col-sm-12 col-md-8 text-right">
                    <ul class="top-bar-menu">
                        <li class="nav-item dropdown   usm-menus ">
                            <a class="nav-link dropdown-toggle link-top-bar"  data-toggle="dropdown" id="dp-categorias2" aria-expanded="false">Minuta</a>
                            <ul class="dropdown-menu fade-up" aria-labelledby="dp-categorias2" style="">                    
                                <li><a  target="_blank" class="dropdown-item">Casa Central Valparaíso</a></li>
                                <li><a  target="_blank" class="dropdown-item">Vitacura</a></li>
                                <li><a  target="_blank" class="dropdown-item">Vińa del Mar</a></li>
                                <li><a target="_blank" class="dropdown-item">Concepción</a></li>
                                <li><a target="_blank" class="dropdown-item">San Joaquín</a></li>
                            </ul>
                        </li>
                        
                        <li>
                            <span class="link-top-bar single-link external">Usuario</span>
                        </li>
                        <li>
                            <a class="link-top-bar single-link" href="Homepage.html">Cerrar sesión</a>
                        </li>              
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="row wrap-menu">
        <div class="container">
            <div class="row justify-content-between align-items-center">
                <div class="col-md-3 logo-usm">
                    <a [routerlink]="[&#39;/&#39;]" class="brand-link">
                        <img src="./MisConsumos_files/logo-usm.svg" alt="Universidad Técnica Federico Santa María">
                    </a>
                </div>
                <div class="col-md-3 text-right">
                </div>
            </div>
        </div>
    </div>
    <div class="row wrap-menu-mobile">
        <div class="container">
            <div class="row justify-content-between align-items-center" style="padding-left: .65rem">
                <div class="col-6 col-sm-6 col-md-5 col-lg-4">
                    <a [routerlink]="[&#39;/&#39;]" class="brand-link">
                        <img src="./MisConsumos_files/logo-usm.svg" alt="Universidad Técnica Federico Santa María">
                    </a>
               </div>
                <div class="col-4 col-md-3 col-sm-6 text-right">
                    <a class="wrap-icon-menu toggle-menu">
                        <i class="fas fa-bars"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="container-fluid wrap-items-menu-mobile" style="display: block;">
            <div class="row" id="collapseMain">
                <div class="navbar-menu-mobile blue-menu" style="padding-left: .65rem">
                    
                    <a href="ReservaDeMenu.html" class="item-navbar-mobile">Reserva de menú</a>
                    <a href="MisReservas.html" class="item-navbar-mobile">Mis reservas</a>
                    <a href="MisConsumos.html" class="item-navbar-mobile">Mis consumos</a>
                    <a href="ComprarAlmuerzos.html" class="item-navbar-mobile">Comprar almuerzos</a>
                    <a href="ProgramacionMenu.html" class="item-navbar-mobile">Programación Menú</a>
                    <a href="CajaComentarios.html" class="item-navbar-mobile">Caja de Comentarios</a>
                    <a href="Visualizaciones.html" class="item-navbar-mobile">Visualizaciones</a>
                    <a id="linkVisualizacionesMobile" href="Visualizaciones.html" class="item-navbar-mobile">Visualizaciones</a>
                    
                    
                <div class="wrap-collapse-mobile">
                    <a class="item-navbar-mobile collapsed" data-toggle="collapse" aria-controls="collapseColacion" aria-expanded="false">Minuta<i class="fas fa-angle-down"></i></a>
                        <div class="collapse-items-mobile collapse" id="collapseMinuta" data-parent="#collapseMain" style="">      
                            <div class="navbar-menu-mobile">                 
                                <a target="_blank" class="item-navbar-mobile">Casa Central Valparaíso</a>
                                <a target="_blank" class="item-navbar-mobile">Vitacura</a>
                                <a  target="_blank" class="item-navbar-mobile">Vińa del Mar</a>
                                <a  target="_blank" class="item-navbar-mobile">Concepción</a>
                                <a target="_blank" class="item-navbar-mobile">San Joaquín</a>
                            </div>
                        </div>    
                    
                </div>

                 
                </div>
            </div>
        </div>
    </div>
</header>
<div class="container">
    
    <div class="form-group row justify-content-center mt-3 text-center">
        <div class="col">
            
            <main>
                <ul class="nav nav-tabs tabs-superior ocultar-tab-mobile" id="tabs-superior ">
                    
                    <li class="nav-item">
                        <a href="ReservaDeMenu.html" class="nav-link ">Reserva de menú</a>  
                    </li>
                    <li class="nav-item">
                        <a href="MisReservas.html" class="nav-link ">Mis reservas</a>
                    </li>
                    <li class="nav-item">
                        <a href="MisConsumos.html" class="nav-link  active ">Mis consumos</a>
                    </li>
                    <li class="nav-item">
                        <a href="ComprarAlmuerzos.html" class="nav-link ">Comprar almuerzos</a>
                    </li>
                    <li class="nav-item">
                        <a href="ProgramacionMenu.html" class="nav-link">Programación Menú</a>
                    </li>
                    <li class="nav-item">
                        <a href="CajaComentarios.html" class="nav-link">Caja de Comentarios</a>
                    </li>
                    <li class="nav-item">
                        <a id="linkVisualizacionesDesktop" href="Visualizaciones.html" class="nav-link">Visualizaciones</a>
                    </li>
                </ul>
            </main>
        <div class="">
            <div class="card">
                <div class="card-body">                        
                        <div id="alertFecha" class="form-group row mt-3 justify-content-center"> 
                            
                            <div class="col-md-2 col-sm-12">
                                <div class="row justify-content-center">
                                    <div class="col-15">
                                        <h5>Disponibles</h5>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <!--<div class="col-auto">
                                        <div class="border rounded-circle bg-info text-white" style="width: 75px;height: 75px;padding-top: 50%; border-color: #bee5eb!important;background-color: #d1ecf1!important;"> 
                                            <p style="  transform: translateY(-50%); font-size: 30px;color: #0c5460;"> 
                                                <strong>6</strong>
                                            </p>
                                        </div>
                                    </div>-->
                                    <div class="panel-heading">
                                        <button type="button" class="alert alert-info btn-circle btn-xl card-effect__usm">
                                            <small>Almuerzos</small><br><strong><span id="almuerzosBtn">...</span></strong>
                                        </button>
                                        <button type="button" class="alert alert-info btn-circle btn-xl card-effect__usm">
                                            <small>Cenas</small><br><strong><span id="cenasBtn">...</span></strong>
                                        </button>
                                    </div>
                                    
                                </div>
                                <div class="row justify-content-center">
                                    <div class="col-auto">
                                        
                                    </div>
                                </div>
                                <br>
                            </div>                       
                            <div class="col-1 d-sm-none d-md-inline "></div>
                             

                            <div class="alert alert-info alertalert-info-dismissible fade col-md-8 col-sm-12 show text-center" role="alert">                                
                                <strong>Información</strong><br>
                                    Se muestran los consumos de los últimos <strong>90</strong> días.<br>
                            </div>
                        </div>

                        <div class="form-group  row mt-3 justify-content-center">
                            <div class="col-sm-12 col-md-12 mb-12" style="overflow-x: scroll">
                                <div id="fechas_wrapper" class="dataTables_wrapper no-footer"><table class="table table-bordered dataTable no-footer" id="fechas" role="grid" aria-describedby="fechas_info" style="width: 1147px;">
                                    <thead>
                                        <tr role="row"><th class="sorting_asc" tabindex="0" aria-controls="fechas" rowspan="1" colspan="1" aria-sort="ascending" aria-label=" N° : activate to sort column descending" style="width: 34px;"> N° </th><th class="sorting" tabindex="0" aria-controls="fechas" rowspan="1" colspan="1" aria-label=" Fecha : activate to sort column ascending" style="width: 91px;"> Fecha </th><th class="sorting" tabindex="0" aria-controls="fechas" rowspan="1" colspan="1" aria-label=" Hora : activate to sort column ascending" style="width: 56px;"> Hora </th><th class="sorting" tabindex="0" aria-controls="fechas" rowspan="1" colspan="1" aria-label=" Tipo consumo : activate to sort column ascending" style="width: 147px;"> Tipo consumo </th><th class="sorting" tabindex="0" aria-controls="fechas" rowspan="1" colspan="1" aria-label=" Campus/Sede consumo : activate to sort column ascending" style="width: 239px;"> Campus/Sede consumo </th><th class="sorting" tabindex="0" aria-controls="fechas" rowspan="1" colspan="1" aria-label=" Comedor : activate to sort column ascending" style="width: 248px;"> Comedor </th><th class="sorting" tabindex="0" aria-controls="fechas" rowspan="1" colspan="1" aria-label=" Menú : activate to sort column ascending" style="width: 66px;"> Menú </th> <th>Agregar reseña</th></tr>
                                    </thead>
                                    <tbody>
                                    <tr role="row" class="odd"><td class="sorting_1">1</td><td>10-04-2025</td><td>12:36</td><td>Almuerzo</td><td> San Joaquín</td><td>Segundo Piso (funcionarios)</td><td>Común</td></tr><tr role="row" class="even"><td class="sorting_1">2</td><td>07-04-2025</td><td>12:33</td><td>Almuerzo</td><td> San Joaquín</td><td>Primer Piso (alumnos)</td><td>Común</td></tr><tr role="row" class="odd"><td class="sorting_1">3</td><td>31-03-2025</td><td>13:33</td><td>Almuerzo</td><td> San Joaquín</td><td>Segundo Piso (funcionarios)</td><td>Común</td></tr><tr role="row" class="even"><td class="sorting_1">4</td><td>27-03-2025</td><td>13:03</td><td>Almuerzo</td><td> San Joaquín</td><td>Segundo Piso (funcionarios)</td><td>Común</td></tr><tr role="row" class="odd"><td class="sorting_1">5</td><td>20-03-2025</td><td>12:33</td><td>Almuerzo</td><td> San Joaquín</td><td>Segundo Piso (funcionarios)</td><td>Común</td></tr><tr role="row" class="even"><td class="sorting_1">6</td><td>13-03-2025</td><td>13:53</td><td>Almuerzo</td><td> San Joaquín</td><td>Segundo Piso (funcionarios)</td><td>Común</td></tr><tr role="row" class="odd"><td class="sorting_1">7</td><td>10-03-2025</td><td>13:52</td><td>Almuerzo</td><td> San Joaquín</td><td>Segundo Piso (funcionarios)</td><td>Común</td></tr></tbody>
                                </table><div class="dataTables_info" id="fechas_info" role="status" aria-live="polite"> </div></div>
                            </div>
                        </div>                        
                        <script>
                            async function cargarStockEnBotones() {
                                try {
                                    const res = await fetch("stock.json");
                                    const data = await res.json();
                        
                                    // Obtener la cantidad de almuerzos desde localStorage
                                    let almuerzosEnLocalStorage = localStorage.getItem("almuerzosComprados");
                                    almuerzosEnLocalStorage = almuerzosEnLocalStorage ? parseInt(almuerzosEnLocalStorage) : 0;
                                    console.log(almuerzosEnLocalStorage, data);
                                    // Calcular el total de almuerzos
                                    const totalAlmuerzos = data.almuerzos + almuerzosEnLocalStorage;
                        
                                    // Actualizar el contenido de los botones con el total
                                    document.getElementById("almuerzosBtn").textContent = totalAlmuerzos;
                                    document.getElementById("cenasBtn").textContent = data.cenas;
                                } catch (error) {
                                    console.error("Error cargando stock:", error);
                                    document.getElementById("almuerzosBtn").textContent = "N/D";
                                    document.getElementById("cenasBtn").textContent = "N/D";
                                }
                            }
                        
                            // Ejecutar al cargar la página
                            window.addEventListener("DOMContentLoaded", () => {
                                cargarStockEnBotones();
                            });
                        </script>
                    </div>
                </div>      
            </div>
        <div class="modal fade" data-keyboard="false" data-backdrop="static" id="informacionBloqueadaGeneral" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="TitleInformcacionBloqueadaGeneral">Modal title</h5>
                    </div>
                    <div class="modal-body" id="contenidoInformacionBloqueadaGeneral">

                    </div>
                    <div class="modal-footer" id="footerInformacionBloqueadaGeneral">

                    </div>
                </div> 
            </div>
        </div>
        
        <div class="modal fade" id="informaModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="informaModalTitle">Informacion</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div id="informaModalBody" class="modal-body">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-usm" data-dismiss="modal">Aceptar</button>                
                    </div>
                </div>
            </div>
        </div>
        
                   </div>
         </div>
        </div> 
         <!-- container -->
        <div class="modal fade" id="informaModalG" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="informaModalTitleG">Información</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div id="informaModalBodyG" class="modal-body">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-usm" data-dismiss="modal">Aceptar</button>                
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" data-keyboard="false" data-backdrop="static" id="informacionBloqueadaGeneralG" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="TitleInformcacionBloqueadaGeneralG">Modal title</h5>
                    </div>
                    <div class="modal-body" id="contenidoInformacionBloqueadaGeneralG">

                    </div>
                    <div class="modal-footer" id="footerInformacionBloqueadaGeneralG">

                    </div>
                </div> 
            </div>
        </div>
        <div id="modalCargarG" class="modal fade" data-keyboard="false" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document" style="background: none">
              <div class="modal-content " style="width: 400px; height: 400px; background: none; border: none;">
                <div class="modal-body" style="padding-top: 100px; background: none;">
                    <div class="fa-7x">
                        <i style="color: #004b85" class="fas fa-sync fa-spin">
                        </i>
                   </div>
                </div>
              </div>
            </div>
        </div>
    <footer id="footer" class="container-fluid footer-interno">
    
    <div class="row footer3 fixed-bottom">
        <div class="container">
             <p class="small fixed-p">Sitio web administrado por <a [routerlink]="[&#39;/&#39;]" class="link-white-footer external admin-titulo">Dirección General de Sistemas de Gestión</a></p>
             <!--<p class="small">Sitio web administrado por la <a href="https://usm.cl/" target="_blank" class="link-white-footer external admin-titulo">Dirección ERP</a></p>-->
        </div>
    </div>
    </footer>
        <script src="./MisConsumos_files/jquery-3.5.1.min.js.descarga"></script>
        <script src="./MisConsumos_files/bootstrap.bundle.min.js.descarga"></script>
        <script src="./MisConsumos_files/bootstrap.min.js.descarga"></script>
        <script src="./MisConsumos_files/menu.js.descarga"></script>
        <script>
            window.addEventListener("DOMContentLoaded", () => {
                const role = localStorage.getItem("userRole");
                // Si no es administrador, ocultamos la pestaña Visualizaciones
                if (role !== "admin") {
                const desktopLink = document.getElementById("linkVisualizacionesDesktop");
                const mobileLink  = document.getElementById("linkVisualizacionesMobile");
                if (desktopLink) desktopLink.style.display = "none";
                if (mobileLink)  mobileLink.style.display = "none";
                }
            });
        </script>
        <script type="text/javascript">
        function modalCargandoAbrirG(){
            $("#modalCargarG").modal("show");    
        }
        function modalCargandoCloseG(){
            $("#modalCargarG").modal("hide");    
        }
        function informaModal(titulo,mensaje){
          $("#informaModalTitleG").html(titulo);
          $("#informaModalBodyG").html(mensaje);
          if (!$("#informaModalG").hasClass("show")) {
              $("#informaModalG").modal("show");
          }
        }          
        function abrirModalBloqueadaGeneral(TituloModal, htmlForContent, htmlFooter) {
            $("#footerInformacionBloqueadaGeneralG").html("");
            $("#TitleInformcacionBloqueadaGeneralG").html("");
            $("#TitleInformcacionBloqueadaGeneralG").append(TituloModal);
            $("#contenidoInformacionBloqueadaGeneralG").html("")
            $("#contenidoInformacionBloqueadaGeneralG").append(htmlForContent);
            $("#footerInformacionBloqueadaGeneralG").html(htmlFooter);
            if (!$("#informacionBloqueadaGeneralG").hasClass("show")) {
                $("#informacionBloqueadaGeneralG").modal("show");
            }            
        }
        function cerrarModalBloqueadaGeneral() {
            
            if ($("#informacionBloqueadaGeneralG").hasClass("show")) {
                $("#informacionBloqueadaGeneralG").modal("hide");
            }            
        }
        function consultaAjaxeJson(url,propiedades,personalFuction,functionError){
                //console.log("hola 1");
                //console.log(propiedades);
                if(functionError==undefined){
                functionError=function(){};
            }
                jQuery.ajax({
                'type': 'POST',
                'url': url,
                //'contentType': 'application/x-www-form-urlencoded',
                'data': propiedades,
                        'dataType': 'text',
                        success: function(rest){
                                //console.log(rest);
                                personalFuction(rest);
                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                                console.log("consultaAjaxeJson: error");
                                functionError();
                          alert(xhr.status);
                          alert(thrownError);
                        },timeout: 300000 
            });
        }
        </script>
       
        <script src="./MisConsumos_files/moment.js.descarga" type="text/javascript"></script>
        <script src="./MisConsumos_files/bootstrap-datepicker.js.descarga" type="text/javascript"></script>
        <script src="./MisConsumos_files/daterangepicker.js.descarga" type="text/javascript"></script>        
        <script src="./MisConsumos_files/datatables.min.js.descarga" type="text/javascript"></script>
        <script src="./MisConsumos_files/select2.min.js.descarga" type="text/javascript"></script>
        <!-- Bootstrap JS (para modales) -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

<!-- DataTables JS (para la tabla dinámica con botón de reseña) -->
<script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>

        <script type="text/javascript">
            
        function abrirModalResena(id) {
            const resenas = JSON.parse(localStorage.getItem('resenas') || '{}');
            const resena = resenas[id] || {};
            document.getElementById('resenaId').value = id;
            document.getElementById('resenaEstrellas').value = resena.estrellas || '';
            document.getElementById('resenaComentario').value = resena.comentario || '';
            $('#modalResena').modal('show');
        }

        function guardarResena() {
            const id = document.getElementById('resenaId').value;
            const estrellas = parseInt(document.getElementById('resenaEstrellas').value);
            const comentario = document.getElementById('resenaComentario').value;
            const plato = document.getElementById('resenaPlato').value;

            if (!estrellas || estrellas < 1 || estrellas > 5 || !comentario.trim() || !plato) {
            alert('Por favor completa una calificación válida y un comentario.');
            return;
            }

            const resenas = JSON.parse(localStorage.getItem('resenas') || '{}');
            resenas[id] = { estrellas, comentario, plato };
            localStorage.setItem('resenas', JSON.stringify(resenas));
            $('#modalResena').modal('hide');
            alert('¡Reseña guardada correctamente!');
        }
                var tableG= $("#fechas").DataTable({
                    "language": {
                        "info": " ",
                        "emptyTable": "No cuenta con información de consumo.",
                        "infoEmpty": ""
                    },data:[{"fecha":"10-04-2025","comedor":"Segundo Piso (funcionarios)","nommenu":"Común","nomSede":" San Joaquín","sede":"7","hora":"12:36","tipoconsumo":"Almuerzo","ide":"1","beca":"Sin Beca Alimentación USM"},{"fecha":"07-04-2025","comedor":"Primer Piso (alumnos)","nommenu":"Común","nomSede":" San Joaquín","sede":"7","hora":"12:33","tipoconsumo":"Almuerzo","ide":"2","beca":"Sin Beca Alimentación USM"},{"fecha":"31-03-2025","comedor":"Segundo Piso (funcionarios)","nommenu":"Común","nomSede":" San Joaquín","sede":"7","hora":"13:33","tipoconsumo":"Almuerzo","ide":"3","beca":"Sin Beca Alimentación USM"},{"fecha":"27-03-2025","comedor":"Segundo Piso (funcionarios)","nommenu":"Común","nomSede":" San Joaquín","sede":"7","hora":"13:03","tipoconsumo":"Almuerzo","ide":"4","beca":"Sin Beca Alimentación USM"},{"fecha":"20-03-2025","comedor":"Segundo Piso (funcionarios)","nommenu":"Común","nomSede":" San Joaquín","sede":"7","hora":"12:33","tipoconsumo":"Almuerzo","ide":"5","beca":"Sin Beca Alimentación USM"},{"fecha":"13-03-2025","comedor":"Segundo Piso (funcionarios)","nommenu":"Común","nomSede":" San Joaquín","sede":"7","hora":"13:53","tipoconsumo":"Almuerzo","ide":"6","beca":"Sin Beca Alimentación USM"},{"fecha":"10-03-2025","comedor":"Segundo Piso (funcionarios)","nommenu":"Común","nomSede":" San Joaquín","sede":"7","hora":"13:52","tipoconsumo":"Almuerzo","ide":"7","beca":"Sin Beca Alimentación USM"}] ,
                    "drawCallback": function( settings ) {
                       //$("#turno").trigger("change");
                   },
                    createdRow: function (row, data, dataIndex) {                               

                    },
                    
                    columns: [{ 
                            render: function (data, type, row, meta) {

                                return row.ide;
                            }
                        },{ 
                            render: function (data, type, row, meta) {

                                return row.fecha;
                            }
                        },{
                            render: function (data, type, row, meta) {

                                return row.hora;
                            }
                        },{
                            render: function (data, type, row, meta) {

                                return row.tipoconsumo;
                            }
                        },{
                            render: function (data, type, row, meta) {
                                return row.nomSede;
                            }
                        },{
                            render: function (data, type, row, meta) {
                                return row.comedor;
                            }
                        },{
                            render: function (data, type, row, meta) {
                                return row.nommenu;
                            }
                        },{
                            render: function (data, type, row, meta) {
                                return `<button class="btn btn-sm btn-primary" onclick="abrirModalResena('${row.ide}')">⭐</button>`;
                            }
                        }
                    ],

                    paging: false,
                    "searching": false,
                    "order": [[ 0, "asc" ]],
                    responsive: true
                });
        </script>
    <div class="modal fade" id="modalResena" tabindex="-1" role="dialog" aria-labelledby="resenaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Escribir reseña</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <form id="formResena">
            <input type="hidden" id="resenaId">
            <div class="form-group">
                <label for="resenaPlato">Plato consumido:</label>
                <select class="form-control" id="resenaPlato" required>
                    <option value="">Seleccione</option>
                    <option value="Lasaña">Lasaña</option>
                    <option value="Pastel de Choclo">Pastel de Choclo</option>
                    <option value="Ensalada">Ensalada</option>
                </select>
            </div>
            <div class="form-group">
                <label for="resenaEstrellas">Calificación (1-5) ⭐:</label>
                <input type="number" class="form-control" id="resenaEstrellas" min="1" max="5" required>
            </div>
            <div class="form-group">
                <label for="resenaComentario">Comentario:</label>
                <textarea class="form-control" id="resenaComentario" rows="3" required></textarea>
            </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary" onclick="guardarResena()">Guardar</button>
        </div>
        </div>
    </div>
</div>

</body></html>